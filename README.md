# DeepRolePlay: åŸºäºå¤šæ™ºèƒ½ä½“æ¶æ„çš„æ·±åº¦è§’è‰²æ‰®æ¼”ç³»ç»Ÿ

[English](README_en.md) | ä¸­æ–‡

## é¡¹ç›®æ¦‚è¿°

DeepRolePlay æ˜¯ä¸€ä¸ªçªç ´æ€§çš„å¤šæ™ºèƒ½ä½“è§’è‰²æ‰®æ¼”ç³»ç»Ÿï¼Œé€šè¿‡ Agent åä½œæœºåˆ¶å½»åº•è§£å†³ä¼ ç»Ÿå¤§è¯­è¨€æ¨¡å‹çš„è§’è‰²é—å¿˜é—®é¢˜ã€‚

DeepRolePlay é‡‡ç”¨å¤šæ™ºèƒ½ä½“åˆ†å·¥æ¶æ„ï¼š**è®°å¿†é—ªå›æ™ºèƒ½ä½“** + **æƒ…æ™¯æ›´æ–°æ™ºèƒ½ä½“** + **ä¸»å¯¹è¯æ¨¡å‹**ï¼Œè®© AI å‘Šåˆ«è§’è‰²é—å¿˜ï¼Œå®ç°çœŸæ­£è¿è´¯çš„è§’è‰²æ‰®æ¼”ã€‚

## ğŸš€ è§£å†³è§’è‰²æ‰®æ¼”æ ¸å¿ƒç—›ç‚¹

<img src="pics/generate.png" alt="DeepRolePlayæ¼”ç¤º" width="150">

### ğŸ˜¤ ä½ æ˜¯å¦é‡åˆ°è¿‡è¿™äº›é—®é¢˜ï¼Ÿ
- ğŸ¤– **AI çªç„¶å¿˜è®°è§’è‰²è®¾å®š**ï¼šæ˜æ˜æ˜¯æ³•å¸ˆå´æ‹¿èµ·äº†å‰‘
- ğŸ“– **å‰§æƒ…å‰åä¸ä¸€è‡´**ï¼šæ˜¨å¤©çš„é‡è¦æƒ…èŠ‚ä»Šå¤©å®Œå…¨ä¸è®°å¾—
- ğŸ’¸ **Token æ¶ˆè€—å·¨å¤§**ï¼šé•¿å¯¹è¯è´¹ç”¨é£æ¶¨ï¼Œä½“éªŒä¸­æ–­

### âœ… DeepRolePlay çš„è§£å†³æ–¹æ¡ˆ
- ğŸ§  **æ°¸ä¸é—å¿˜**ï¼šAgent è‡ªåŠ¨ç»´æŠ¤è§’è‰²è®°å¿†ï¼Œè®¾å®šæ°¸ä¹…ä¿æŒ
- ğŸ”„ **å‰§æƒ…è¿è´¯**ï¼šæ™ºèƒ½æƒ…æ™¯æ›´æ–°ï¼Œåƒä¸‡è½®å¯¹è¯ä¾ç„¶é€»è¾‘æ¸…æ™°  
- ğŸ’° **æˆæœ¬å¯æ§**ï¼šæƒ…æ™¯å‹ç¼©æŠ€æœ¯ï¼Œé•¿å¯¹è¯è´¹ç”¨é™ä½ 80%
- ğŸ“š **æ™ºèƒ½è”ç½‘**ï¼šé›†æˆ Wikipedia ç™¾ç§‘ï¼Œå…è´¹è‡ªåŠ¨è¡¥å…¨è§’è‰²èƒŒæ™¯å’Œæ•…äº‹è®¾å®š
- âš¡ **å³æ’å³ç”¨**ï¼š5åˆ†é’Ÿé›†æˆï¼ŒSillyTavern ç­‰å¹³å°ç›´æ¥ä½¿ç”¨
- ğŸš€ **è¶…é«˜é€Ÿå“åº”**ï¼šé‡‡ç”¨ Gemini 2.5 Flash æ™ºèƒ½ä»£ç†ï¼Œä»…æ¯”æ­£å¸¸å›å¤å¤š 20-30 ç§’

## ğŸ¯ å¦‚ä½•ä½¿ç”¨

### ğŸ’¾ å¿«é€Ÿä¸Šæ‰‹ - ä¸‹è½½å³ç”¨ç‰ˆæœ¬

1. **ğŸ“¦ è§£å‹è½¯ä»¶åŒ…**
   - ä¸‹è½½å‘å¸ƒçš„è½¯ä»¶åŒ…å¹¶è§£å‹åˆ°**éä¸­æ–‡è·¯å¾„**ä¸‹
   - è§£å‹åæ–‡ä»¶å¤¹åŒ…å«ï¼š`config.yaml` é…ç½®æ–‡ä»¶ + `DeepRolePlay.exe` ä¸»ç¨‹åº

2. **âš™ï¸ ä¿®æ”¹é…ç½®æ–‡ä»¶**
   
   ç¼–è¾‘ `config.yaml` æ–‡ä»¶ï¼Œ**å¼ºçƒˆæ¨èæ™ºèƒ½ä»£ç†ä½¿ç”¨ Gemini 2.5 Flashï¼ˆå“åº”ä»…æ¯”æ­£å¸¸å¤š20ç§’ï¼‰**ï¼š

   ```yaml
   # APIä»£ç†é…ç½® - è½¬å‘ç›®æ ‡
   proxy:
     target_url: "https://api.deepseek.com/v1"                      # ä½ è¦è½¬å‘çš„APIåœ°å€ï¼Œæ¨èdeepseek
     timeout: 60                                                     # å»ºè®®è®¾ç½®60ç§’
   
   # æ™ºèƒ½ä½“é…ç½® - Agent ä½¿ç”¨çš„æ¨¡å‹ï¼ˆå¿…é¡»æ˜¯Gemini 2.5 Flashï¼‰
   agent:
     model: "gemini-2.5-flash"                                       # å¼ºçƒˆæ¨è ä½¿ç”¨ Gemini 2.5 Flash
     base_url: "https://generativelanguage.googleapis.com/v1beta"   # Gemini APIåœ°å€
     api_key: "your-gemini-api-key"                                  # å¡«å…¥ä½ çš„ Gemini API Key
     temperature: 0.7
     max_iterations: 25
   
   # æœåŠ¡å™¨é…ç½®
   server:
     host: "0.0.0.0"
     port: 6666                                                      # è®°ä½è¿™ä¸ªç«¯å£å·
   ```

3. **ğŸš€ å¯åŠ¨ç¨‹åº**
   - åŒå‡» `DeepRolePlay.exe` å¯åŠ¨
   - çœ‹åˆ° "æœåŠ¡å·²å¯åŠ¨" æç¤ºå³å¯

4. **ğŸ”— é…ç½®è§’è‰²æ‰®æ¼”å‰ç«¯**
   - åœ¨ SillyTavernã€OpenWebUI ç­‰å¹³å°ä¸­
   - å°† `base_url` æ”¹ä¸ºï¼š`http://localhost:6666/v1`
   - API Key ä¿æŒä¸å˜ï¼ˆä¼šè‡ªåŠ¨è½¬å‘ï¼‰
   - **é‡è¦**ï¼šå…³é—­å†å²è®°å½•é™åˆ¶ï¼ŒåŠ¡å¿…å‘é€å…¨éƒ¨å†å²è®°å½•ç»™ä»£ç†ï¼ï¼ˆä¸ç”¨æ‹…å¿ƒtokençˆ†ç‚¸ï¼Œmax_history_lengthä¼šæ§åˆ¶ï¼‰

5. **ğŸ­ å¼€å§‹è§’è‰²æ‰®æ¼”**
   - ç«‹å³äº«å—æ— é—å¿˜çš„è§’è‰²æ‰®æ¼”ä½“éªŒï¼

### ğŸ”§ å…¼å®¹æ€§è¯´æ˜
- âœ… **å®Œå…¨å…¼å®¹ OpenAI API æ ¼å¼**ï¼šæ‰€æœ‰æ”¯æŒ OpenAI çš„å·¥å…·éƒ½èƒ½ç›´æ¥ä½¿ç”¨
- âœ… **æ”¯æŒä¸»æµæ¨¡å‹**ï¼šGeminiã€DeepSeekã€Claudeã€æœ¬åœ° Ollama ç­‰
- âœ… **åŒé‡é…ç½®**ï¼šAgent å’Œè½¬å‘ç›®æ ‡å¯ä½¿ç”¨ä¸åŒæ¨¡å‹ï¼Œæˆæœ¬ä¼˜åŒ–çµæ´»

## Agent å·¥ä½œåŸç†

ä¼ ç»Ÿå•ä¸€æ¨¡å‹çš„é—®é¢˜ï¼š**è§’è‰²é—å¿˜** â†’ **å‰§æƒ…æ–­è£‚** â†’ **ä½“éªŒå´©å**

DeepRolePlay çš„ Agent è§£å†³æ–¹æ¡ˆï¼š
- ğŸ” **è®°å¿†é—ªå›æ™ºèƒ½ä½“**ï¼šæ™ºèƒ½æ£€ç´¢å†å²å¯¹è¯å’Œå¤–éƒ¨çŸ¥è¯†
- ğŸ“ **æƒ…æ™¯æ›´æ–°æ™ºèƒ½ä½“**ï¼šå®æ—¶ç»´æŠ¤è§’è‰²çŠ¶æ€å’Œå‰§æƒ…è¿è´¯æ€§  
- ğŸ­ **ä¸»å¯¹è¯æ¨¡å‹**ï¼šåŸºäºå®Œæ•´ä¸Šä¸‹æ–‡ç”Ÿæˆè§’è‰²å›åº”

## å·¥ä½œæµç¨‹

```
ç”¨æˆ·è¯·æ±‚ -> HTTPä»£ç†æœåŠ¡
           |
           v
    è§¦å‘å·¥ä½œæµæ‰§è¡Œ
           |
    +------+------+
    |             |
    v             v
è®°å¿†é—ªå›      æƒ…æ™¯æ›´æ–°
æ™ºèƒ½ä½“        æ™ºèƒ½ä½“
    |             |
    +------+------+
           |
           v
    æ³¨å…¥æ›´æ–°çš„æƒ…æ™¯
           |
           v
    è½¬å‘è‡³ç›®æ ‡LLM
           |
           v
    è¿”å›å¢å¼ºå“åº”
```

## å¼€å‘è€…å¸®åŠ©

### ç¯å¢ƒè¦æ±‚

- Python 3.12
- UV è™šæ‹Ÿç¯å¢ƒç®¡ç†å™¨ï¼ˆæ¨èï¼‰

### 1. å®‰è£…é¡¹ç›®

```bash
git clone https://github.com/yourusername/deepRolePlay.git
cd deepRolePlay
uv venv --python 3.12
uv pip install -r requirements.txt
```

### 2. é…ç½®æœåŠ¡

ç¼–è¾‘ `config/config.yaml` æ–‡ä»¶ï¼Œ**æ¨èä½¿ç”¨ Gemini 2.5 Flashï¼ˆå“åº”å¿«ï¼‰**ï¼š

```yaml
# APIä»£ç†é…ç½® - è½¬å‘ç›®æ ‡
proxy:
  target_url: "https://api.deepseek.com/v1"                      # ä½ è¦è½¬å‘çš„APIåœ°å€
  timeout: 60                                                     # è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰

# æ™ºèƒ½ä½“é…ç½® - Agent ä½¿ç”¨çš„æ¨¡å‹ï¼ˆå¿…é¡»æ˜¯Gemini 2.5 Flashï¼‰
agent:
  model: "gemini-2.5-flash"                                       # å¿…é¡»ä½¿ç”¨ Gemini 2.5 Flash
  base_url: "https://generativelanguage.googleapis.com/v1beta"   # Gemini APIåœ°å€
  api_key: "your-gemini-api-key"                                  # å¡«å…¥ä½ çš„ Gemini API Key
  temperature: 0.7                                                # ç”Ÿæˆæ¸©åº¦ï¼ˆ0-1ï¼‰
  max_iterations: 25                                              # æœ€å¤§è¿­ä»£æ¬¡æ•°

# æƒ…æ™¯ç®¡ç†
scenario:
  file_path: "./scenarios/scenario.txt"      # æƒ…æ™¯æ–‡ä»¶è·¯å¾„
  update_enabled: true                        # æ˜¯å¦å¯ç”¨è‡ªåŠ¨æ›´æ–°

# æœåŠ¡å™¨é…ç½®
server:
  host: "0.0.0.0"
  port: 6666
```

### 3. å¯åŠ¨æœåŠ¡

```bash
uv run python main.py
```

### 4. æ¥å…¥ä½¿ç”¨

å°†ä½ çš„ AI åº”ç”¨ï¼ˆSillyTavernã€OpenWebUI ç­‰ï¼‰çš„ API ç«¯ç‚¹æ”¹ä¸ºï¼š
```
http://localhost:6666/v1
```

ç³»ç»Ÿå°†è‡ªåŠ¨ï¼š
1. æ‹¦æˆªå¯¹è¯è¯·æ±‚
2. æ‰§è¡Œæ™ºèƒ½ä½“å·¥ä½œæµ
3. æ›´æ–°æƒ…æ™¯çŠ¶æ€
4. å°†å¢å¼ºçš„ä¸Šä¸‹æ–‡æ³¨å…¥è¯·æ±‚
5. è¿”å›æ›´å‡†ç¡®çš„è§’è‰²æ‰®æ¼”å“åº”

### 5. æ‰“åŒ…å‘å¸ƒ

ä½¿ç”¨ PyInstaller æ‰“åŒ…ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼š

```bash
pyinstaller --name DeepRolePlay --onefile --clean --console --add-data "src;src" --add-data "utils;utils" main.py
```

æ‰“åŒ…ååœ¨ `dist/` ç›®å½•ä¸‹ä¼šç”Ÿæˆ `DeepRolePlay.exe`ï¼Œè¿åŒé…ç½®æ–‡ä»¶ä¸€èµ·å‘å¸ƒç»™ç”¨æˆ·ã€‚

## æ”¯æŒçš„æ¨¡å‹

### ğŸ”Œ å…¨é¢å…¼å®¹ OpenAI æ ¼å¼ API
æœ¬é¡¹ç›®é‡‡ç”¨æ ‡å‡† OpenAI API æ ¼å¼ï¼Œæ”¯æŒæ‰€æœ‰å…¼å®¹çš„æœåŠ¡å•†ï¼š

- **ğŸŒŸ Gemini 2.5 Flash**ï¼ˆå¼ºçƒˆæ¨èï¼‰ï¼šé€Ÿåº¦æœ€å¿«ï¼Œä»…å¢åŠ 20ç§’å“åº”æ—¶é—´ï¼Œè§’è‰²æ‰®æ¼”æ•ˆæœå‡ºè‰²
- **ğŸ’° DeepSeek**ï¼šæ€§ä»·æ¯”æœ€é«˜ï¼Œæˆæœ¬ä½å»‰
- **ğŸ’» æœ¬åœ° Ollama**ï¼šå®Œå…¨ç§æœ‰åŒ–éƒ¨ç½²ï¼Œæ•°æ®å®‰å…¨

### âš ï¸ ä¸æ¨è OpenAI å®˜æ–¹ API
è™½ç„¶å®Œå…¨å…¼å®¹ OpenAI æ ¼å¼ï¼Œä½†**ä¸å»ºè®®ä½¿ç”¨ OpenAI å®˜æ–¹æœåŠ¡**ï¼š
- ğŸ”’ **è¿‡åº¦å®‰å…¨ç­–ç•¥**ï¼šå¯¹è§’è‰²æ‰®æ¼”å†…å®¹é™åˆ¶ä¸¥æ ¼ï¼Œå½±å“ä½“éªŒ


## å‚è€ƒæ–‡çŒ®

æœ¬é¡¹ç›®çš„è®¾è®¡ç†å¿µå—åˆ°ä»¥ä¸‹ç ”ç©¶çš„å¯å‘ï¼š

- [Building effective agents](https://www.anthropic.com/research/building-effective-agents) - Anthropic
- [LangGraph Documentation](https://python.langchain.com/docs/langgraph) - LangChain

## è®¸å¯è¯

MIT License
